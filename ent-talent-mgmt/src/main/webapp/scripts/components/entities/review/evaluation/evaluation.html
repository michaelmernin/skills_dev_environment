<div ng-cloak>
  <md-list>
    <div ng-repeat="(category, questions) in categories | orderBy:'toString()'">
      <md-list-item ng-click="toggle = !toggle;">
        <div class="md-list-item-text" flex>
          <span class="md-title">{{ category }}</span>
          <span class="score" ng-if="getAvgScore(getRatings(questions, 'reviewee'))">
            <i class="fa fa-comment-o"></i>
            Self: {{ getAvgScore(getRatings(questions, 'reviewee')) }}
          </span>
          <span class="score" ng-if="getAvgScore(getRatings(questions, 'reviewer'))">
            <i class="fa fa-comment"></i>
            Reviewer: {{ getAvgScore(getRatings(questions, 'reviewer')) }}
          </span>
          <span class="score" ng-if="getAvgScore(getRatings(questions, 'peer'))">
            <i class="fa fa-comments-o"></i>
            Peers: {{ getAvgScore(getRatings(questions, 'peer')) }}
          </span>
        </div>
        <i class="fa fa-lg {{toggle ? 'fa-chevron-down' : 'fa-chevron-left'}}"></i>
      </md-list-item>
      <md-list-item ng-if="toggle" ng-repeat="question in questions | orderBy:'position'" ng-click="viewEvaluation(question, $event)" class="md-2-line">
        <div class="md-list-item-text">
          <h4>{{ question.title ? question.title : question.text | limitTo:titleLimit() }}</h4>
          <p>
            <span class="score" ng-if="question.ratings.reviewee.score">
              <i class="fa fa-comment-o"></i>
              Self Rating: {{ getScore(question.ratings.reviewee) }}
            </span>
            <span class="score" ng-if="question.ratings.reviewer.score">
              <i class="fa fa-comment"></i>
              Reviewer Rating: {{ getScore(question.ratings.reviewer) }}
            </span>
            <span class="score" ng-if="getAvgScore(question.ratings.peer)">
              <i class="fa fa-comments-o"></i>
              Average Peer Rating: {{ getAvgScore(question.ratings.peer) }}
            </span>
          </p>
        </div>
        <md-icon md-font-icon="fa fa-lg fa-edit"></md-icon>
      </md-list-item>
      <md-divider ng-if="!$last"></md-divider>
    </div>
  </md-list>
</div>
